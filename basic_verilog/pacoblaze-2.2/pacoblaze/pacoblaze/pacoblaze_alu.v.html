<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<title>pacoblaze_alu.v</title>
<link rel="Stylesheet" title="v2html stylesheet" media="Screen" href="v2html.css">
</head>
<script language="JavaScript" type="text/javascript"><!--
var agt=navigator.userAgent.toLowerCase(); 
var is_nav  = ((agt.indexOf('mozilla')!=-1) &&
(agt.indexOf('spoofer')==-1) &&
(agt.indexOf('compatible') == -1) &&
(agt.indexOf('opera')==-1) &&
(agt.indexOf('webtv')==-1)); 
var is_major = parseInt(navigator.appVersion); 
var is_nav4up = (is_nav && (is_major >= 4)); 
var is_ie     = (agt.indexOf("msie") != -1); 
var is_ie4up  = (is_ie  && (is_major >= 4)); 
var is_nav5up = (is_nav && (is_major >= 5));
var dirSep = (window.location.pathname.indexOf('\\') != -1) ? '\\' : '/' ;
function setbuttons (wndw) {
var i;
var sl=wndw.loc[ wndw.document.forms[0].elements[0].selectedIndex ];
for (i=0;i<sl.length;i++) {
if(sl[i]) wndw.document.images[i].src='v2html-b1.gif';
else      wndw.document.images[i].src='v2html-b2.gif';
}
if ( wndw.document.forms[0].elements[0].options[ 
wndw.document.forms[0].elements[0].selectedIndex ].text != '-') {
wndw.document.images[i  ].src='v2html-b1.gif';
wndw.document.images[i+1].src='v2html-b1.gif';
}
else {
wndw.document.images[i  ].src='v2html-b2.gif';
wndw.document.images[i+1].src='v2html-b2.gif';
}
}
// Unindented and uncommented to save spave - look in v2html for a prettier version
var disabled=1;
if (!is_nav4up) {
var event=false; 
}
var last_link=0;     
var last_class=null; 
function qs(e,t,extra_info_index) {
var inc=0,bnum=0,i,j;
if (disabled) return false;
var sig_buttons = [ "Definition" , "Local Driver" , 
"Up to Input Driver" , "Find Source" , "Index"];
if (is_nav4up || is_ie4up) {
if (((e.which==2) && (!(e.modifiers&Event.SHIFT_MASK))) ||
((e.which==1) &&  (e.modifiers&Event.CONTROL_MASK)))   inc = 1;
else if (((e.which==2) && (e.modifiers&Event.SHIFT_MASK)) ||
((e.which==1) && (e.modifiers&Event.SHIFT_MASK))) inc = -1;
if (inc == 0 && extra_info_index == 0) { 
return true;  
}
var linkText = is_nav4up ? t.text : t.innerText;
var linkY    = is_nav4up && ! is_nav5up ? t.y    : t.offsetTop;
window.status="Searching...";
if ((last_link==-1) || (document.links[last_link]!=t)) 
for (last_link=0;last_link<document.links.length;last_link++) 
if (document.links[last_link] == t)  
break;
if (inc != 0) { 
return search(linkText,linkY,last_link,inc,1);
}
else { 
window.status="";
extra_info_index--; 
if (extra_info[extra_info_index][0] != 'S') { 
return true;
}
var w = window.open('','SignalPopUp','width=200,height=235');
if (null != w.document.forms[0]) {
if ((window.location.pathname.substring(0,window.location.pathname.lastIndexOf(dirSep)))!=
(w.pn.substring(0,w.pn.lastIndexOf(dirSep)))) {
w.close();
w = window.open('','SignalPopUp','width=200,height=235');
}
}
w.focus(); 
if (null == w.document.forms[0]) { 
var Text = '<html><head></head>';
if (is_nav4up) { 
w.loc = new Array(10);
w.sel = null;
w.pn  = window.location.pathname;
}
else {     
Text += '<script>var loc = new Array(10);<\/script>\n';
Text += '<script>var sel;<\/script>\n';
Text += '<script>var pn = opener.location.pathname;<\/script>\n';
}
Text += '<body bgcolor="white">\n';
Text += '<form>';
Text += '  <select onchange="opener.setbuttons(window);">\n';
Text += '  <option>---------------------------</option>\n';
for (j=0;j<9;j++) Text += '  <option>-</option>\n';
Text += '  </select>\n';
Text += '</form>';
Text += '<table cellspacing=0 cellpadding=0>\n';
for (var i=0;i<(extra_info[extra_info_index].length-1);i++) {
Text += hbutton(sig_buttons[i], 
'opener.location=loc[sel.selectedIndex]['+i+'];',
bnum++);
}
Text += hbutton("Search Backwards", 
'opener.search(sel.options[ sel.selectedIndex ].text,' +
'0,opener.last_link,-1,0);',bnum++);
Text += hbutton("Search Forwards",
'opener.search(sel.options[ sel.selectedIndex ].text,' +
'0,opener.last_link, 1,0);',bnum++);
Text += hbutton("Close","window.close();",bnum++);
Text += '</table>\n';
Text += '</body></html>\n';
w.document.open();
w.document.write(Text);
w.document.close();
w.document.forms[0].elements[0].options[0].text  = linkText;
w.sel = w.document.forms[0].elements[0]; 
for (j=0;j<10;j++) w.loc[j] = new Array(sig_buttons.length);  
copy_into_loc0(w,extra_info_index);
}
else {
var opts = w.document.forms[0].elements[0].options;
if ( opts.length<10 ) { 
w.loc[opts.length] = new Array;
opts.length++; 
}
for (i=opts.length-2;i>=0;i--) {
opts[i+1].text=opts[i].text;
for (var j=0;j<w.loc[i].length;j++) w.loc[i+1][j] = w.loc[i][j];
}
opts[0].text  = linkText;
copy_into_loc0(w,extra_info_index);
}
return false; 
}
}
return true;
}
function hbutton (text,action,bnum) {
return '  <tr><td><a href="" '+
'onmousedown="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
'images['+bnum+'].src=\'v2html-b3.gif\';" '+
'onmouseup="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
'images['+bnum+'].src=\'v2html-b1.gif\';" '+
'onclick="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
action + 
' return false;">'+
'<img border=0 src="v2html-b1.gif"></a></td>' +
'<td style="font-family:sans-serif; font-weight:bold; font-size:14px;"> '+text+'</td></tr>\n';
}
function copy_into_loc0 (w,extra_info_index) {
for (var i=1;i<extra_info[extra_info_index].length;i++) {
w.loc[0][i-1] = extra_info[extra_info_index][i];
}
w.document.forms[0].elements[0].selectedIndex=1;
w.document.forms[0].elements[0].selectedIndex=0;
setbuttons(w);
}
function search(text,y,i,inc,relative) {
var nextpage,wrappage,linkText,linkY;
window.status="Searching...";
if (last_class) document.links[i].className=last_class;
while (1) {
for (i+=inc;i<document.links.length && i>=0;i+=inc) {
linkText = is_nav4up ? document.links[i].text : document.links[i].innerText;
linkY    = is_nav4up && ! is_nav5up ? document.links[i].y    : document.links[i].offsetTop;
if ((linkText == text) && (linkY != y)) {
window.status="";
if (is_nav4up) 
if (relative) window.scrollBy(0,linkY - y);
else          window.scrollTo(0,linkY); 
else if (is_ie4up)
document.links[i].scrollIntoView(true); 
last_link=i;
last_class=document.links[i].className;
document.links[i].className='HI';
return false;
}
}
nextpage = (inc==1) ? next_page() : prev_page();
wrappage = (inc==1) ? first_page() : last_page();
if (nextpage!="" || wrappage!="") {
if (nextpage=="") { 
if (!confirm(text + " not found. Search again from "+((inc==1)?"first":"last")+" page?"))
return false;
nextpage=wrappage;
}
location=nextpage+ "?" + escape(text) + "&" + ( y - window.pageYOffset ) + "&" + inc;
return false;
}
if (confirm(text + " not found. Search again from "+((inc==1)?"start":"end")+"?")) {
if (inc==1) i=-1;
else i=document.links.length;
} else return false;
}
return true;
}
function loadqs() {
var opt=location.search, text="", s="", y=0, si=0, inc=1;
if (opt.length==0) return true;  
for (var i=1;i<opt.length;i++) { 
if (opt.charAt(i) != "&") 
s += opt.charAt(i);
else {
if (text=="") text=unescape(s);
else             y=s;
s="";
}
}
if (text=="") return true;
if (s == "-1") { si=document.links.length-1; inc=-1; }
window.scrollTo(0,0);
search(text,y,si,inc);
return true;
}
// -->
</script>
<body onload='loadqs();'>
<script language="JavaScript"type="text/javascript"><!--
function prev_page() { return ""; }
function last_page() { return ""; }
// -->
</script>
<center><table class=NB cols=7 ><tr><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index.html';"><a target="_top" href="index.html">Hierarchy</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-f.html';"><a target="_top" href="index-f.html">Files</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-m.html';"><a target="_top" href="index-m.html">Modules</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-s.html';"><a target="_top" href="index-s.html">Signals</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-t.html';"><a target="_top" href="index-t.html">Tasks</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-fn.html';"><a target="_top" href="index-fn.html">Functions</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='http://www.burbleland.com/v2html/help_7_30.html?htf-ni-s-';"><a target="_top" href="http://www.burbleland.com/v2html/help_7_30.html?htf-ni-s-">Help</a></td></tr></table></center>
<pre>
<span class=C>/*
  Copyright (C) 2004, 2006 Pablo Bleyer Kocik.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

  2. Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

  3. The name of the author may not be used to endorse or promote products
  derived from this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE AUTHOR &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED
  WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
  EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  POSSIBILITY OF SUCH DAMAGE.
*/</span>

<span class=C>/** @file
  PacoBlaze Arithmetic-Logic Unit.
*/</span>

<span class=M>`ifndef</span> <a  onClick="return qs(event,this,0)"  class=D href="#34">PACOBLAZE_ALU_V_</a>
<span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="#34">PACOBLAZE_ALU_V_</a>

<span class=M>`include</span> <a  onClick="return qs(event,this,0)"  class=S href="pacoblaze_inc.v.html">&quot;pacoblaze_inc.v&quot;</a>

<span class=M>`ifdef</span> <span class=D>USE_ONEHOT_ENCODING</span>
<span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(x) operation[(x)]
<span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(x) operation[(x)]
<span class=M>`else</span>
<span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(x) (x)
<span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(x) (operation == (x))
<span class=M>`endif</span>

<span class=K>module</span> <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze1.v.html#14">PACOBLAZE_ALU</a>(
  operation,
  shift_operation, shift_direction, shift_constant,
  result, operand_a, operand_b,
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  resultw, operand_u, operand_v,
<span class=M>`endif</span>
  carry_in, zero_out, carry_out
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu_tb.v.html#36">HAS_DEBUG</a>
  , debug
<span class=M>`endif</span>
);
<span class=K>input</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#149">operation_width</a>-1:0] operation; <span class=C>///&lt; Main operation
</span><span class=K>input</span> [2:0] shift_operation; <span class=C>///&lt; Rotate/shift operation
</span><span class=K>input</span> shift_direction; <span class=C>///&lt; Rotate/shift left(0)/right(1)
</span><span class=K>input</span> shift_constant; <span class=C>///&lt; Shift constant (0 or 1)
</span><span class=K>output</span> <span class=K>reg</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] result; <span class=C>///&lt; ALU result
</span><span class=K>input</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] operand_a, operand_b; <span class=C>///&lt; ALU operands
</span><span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
<span class=K>output</span> <span class=K>reg</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] resultw; <span class=C>///&lt; wide ALU high result
</span><span class=K>input</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] operand_u, operand_v; <span class=C>///&lt; wide ALU high operands
</span><span class=M>`endif</span>
<span class=K>input</span> carry_in; <span class=C>///&lt; Carry in
</span><span class=K>output</span> zero_out; <span class=C>///&lt; Zero out
</span><span class=K>output</span> <span class=K>reg</span> carry_out; <span class=C>///&lt; Carry out
</span>
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu_tb.v.html#36">HAS_DEBUG</a>
<span class=K>output</span> <span class=K>reg</span> [8*<span class=D>`alu_debug_width</span>:1] debug; <span class=C>///&lt; ALU debug string
</span><span class=K>reg</span> [18*8:1] debug_rabc; <span class=C>///&lt; ALU debug operands and result
</span><span class=K>reg</span> [7*8:1] debug_cz; <span class=C>///&lt; ALU debug flags
</span><span class=M>`endif</span>

<span class=C>/** Adder/substracter second operand. */</span>
<span class=K>wire</span> [<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] addsub_b =
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#480">op_sub</a>)
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#481">op_subcy</a>)
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#42">HAS_COMPARE_OPERATION</a>
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#490">op_compare</a>)
<span class=M>`endif</span>
  ) ? ~operand_b :
  operand_b;

<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
<span class=K>wire</span> [2*<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] addsubw_b =
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subw</span>) || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subwcy</span>)) ? ~{operand_v, operand_b} :
  {operand_v, operand_b};
<span class=M>`endif</span>

<span class=C>/** Adder/substracter carry. */</span>
<span class=K>wire</span> addsub_carry =
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#476">op_addcy</a>)
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_addwcy</span>)
<span class=M>`endif</span>
  ) ? carry_in :
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#480">op_sub</a>)
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#42">HAS_COMPARE_OPERATION</a>
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#490">op_compare</a>)
<span class=M>`endif</span>
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subw</span>)
<span class=M>`endif</span>
  ) ? 1 : <span class=C>// ~b =&gt; b'
</span>  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#481">op_subcy</a>)
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subwcy</span>)
<span class=M>`endif</span>
  ) ? ~carry_in : <span class=C>// ~b - c =&gt; b' - c
</span>  0;

<span class=C>/** Adder/substracter with carry. */</span>
<span class=K>wire</span> [1+<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] addsub_result = operand_a + addsub_b + addsub_carry;
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
<span class=K>wire</span> [1+2*<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] addsubw_result =
  {operand_u, operand_a} + addsubw_b + addsub_carry;
<span class=M>`endif</span>

<span class=C>/** Shift bit value. */</span>
<span class=C>// synthesis parallel_case full_case
</span><span class=K>wire</span> shift_bit =
  (shift_operation == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#220">opcode_rr</a>) ? operand_a[0] : <span class=C>// == `opcode_slx
</span>  (shift_operation == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#222">opcode_rl</a>) ? operand_a[7] : <span class=C>// == `opcode_srx
</span>  (shift_operation == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#219">opcode_rsa</a>) ? carry_in :
  shift_constant; <span class=C>// == `opcode_rsc
</span>
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
<span class=K>wire</span> [2*<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#60">operand_width</a>-1:0] resultx = {resultw, result};
<span class=M>`endif</span>

<span class=K>assign</span> zero_out =
<span class=M>`ifdef</span> <span class=D>HAS_MUL_OPERATION</span>
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_mul</span>)) ? ~|resultx :
<span class=M>`endif</span>
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_addw</span>) || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_addwcy</span>)
  || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subw</span>) || <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#43">operation_is</a>(<span class=D>`op_subwcy</span>)
  ) ? ~|resultx :
<span class=M>`endif</span>
  ~|result;


<span class=C>/*
always @(operation,
  shift_operation, shift_direction, shift_constant, shift_bit,
  result, operand_a, operand_b, carry_in, carry_out,
  addsub_result, addsub_b, addsub_carry
`ifdef HAS_WIDE_ALU
  , resultw, operand_v, addsubw_result
`endif
  ) begin
  $display(&quot;op:%b %h (%h)=(%h),(%h)&quot;, operation, operation, result, operand_a, operand_b);
  $display(&quot;as:%h=%h+%h+%b&quot;, addsub_result, operand_a, addsub_b, addsub_carry);
end
*/</span>

<span class=C>// always @*
</span><span class=K>always</span> @(operation,
  shift_operation, shift_direction, shift_constant, shift_bit,
  result, operand_a, operand_b, carry_in, carry_out,
  addsub_result, addsub_carry
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  , resultw, operand_v, addsubw_result
<span class=M>`endif</span>
  ) <span class=K>begin</span>: on_alu
  <span class=C>/* Defaults */</span>
  carry_out = 0;
<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
  resultw = operand_v;
<span class=M>`endif</span>

  <span class=C>// synthesis parallel_case full_case
</span><span class=M>`ifdef</span> <span class=D>USE_ONEHOT_ENCODING</span>
  <span class=K>case</span> (1'b1)
<span class=M>`else</span>
  <span class=K>case</span> (operation)
<span class=M>`endif</span>

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#475">op_add</a>),
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#476">op_addcy</a>):
      {carry_out, result} = addsub_result;

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#42">HAS_COMPARE_OPERATION</a>
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#490">op_compare</a>),
<span class=M>`endif</span>
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#480">op_sub</a>),
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#481">op_subcy</a>): <span class=K>begin</span>
      {carry_out, result} = {~addsub_result[8], addsub_result[7:0]};
    <span class=K>end</span>

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#477">op_and</a>):
      result = operand_a &amp; operand_b;

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#478">op_or</a>):
      result = operand_a | operand_b;

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#43">HAS_TEST_OPERATION</a>
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#491">op_test</a>):
      <span class=K>begin</span> result = operand_a &amp; operand_b; carry_out = ^result; <span class=K>end</span>
<span class=M>`endif</span>

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#482">op_xor</a>):
      result = operand_a ^ operand_b;

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="#42">operation</a>(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_inc.v.html#479">op_rs</a>):
      <span class=K>if</span> (shift_direction) <span class=C>// shift right
</span>        {result, carry_out} = {shift_bit, operand_a};
      <span class=K>else</span> <span class=C>// shift left
</span>        {carry_out, result} = {operand_a, shift_bit};

<span class=M>`ifdef</span> <span class=D>HAS_MUL_OPERATION</span>
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(<span class=D>`op_mul</span>):
      {resultw, result} = operand_a * operand_b;
<span class=M>`endif</span>

<span class=M>`ifdef</span> <span class=D>HAS_WIDE_ALU</span>
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(<span class=D>`op_addw</span>),
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(<span class=D>`op_addwcy</span>):
      {carry_out, resultw, result} = addsubw_result;

    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(<span class=D>`op_subw</span>),
    <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu.v.html#44">operation</a>(<span class=D>`op_subwcy</span>):
      {carry_out, resultw, result} = {~addsubw_result[16], addsubw_result[15:0]};
<span class=M>`endif</span>

    <span class=K>default</span>:
      result = operand_b;

  <span class=K>endcase</span>

<span class=K>end</span>


<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="pacoblaze_idu_tb.v.html#36">HAS_DEBUG</a>

<span class=M>`include</span> <a  onClick="return qs(event,this,0)"  class=S href="pacoblaze_util.v.html">&quot;pacoblaze_util.v&quot;</a>

<span class=K>always</span> @(operand_a, operand_b, result)
  debug_rabc = {<span class=S>&quot;r=&quot;</span>, numtohex(result[7:4]), numtohex(operand_a[3:0]), <span class=S>&quot; a=&quot;</span>, numtohex(operand_a[7:4]), numtohex(operand_a[3:0]), <span class=S>&quot; b=&quot;</span>, numtohex(operand_b[7:4]), numtohex(operand_b[3:0]), <span class=S>&quot; c=&quot;</span>, numtohex(carry_in)};

<span class=K>always</span> @(carry_in, carry_out, zero_out)
  debug_cz = {<span class=S>&quot;C=&quot;</span>, numtohex(carry_out), <span class=S>&quot; Z=&quot;</span>, numtohex(zero_out)};

<span class=K>always</span> @(debug_rabc, debug_cz)
  debug = {debug_rabc, <span class=S>&quot;, &quot;</span>, debug_cz};

<span class=M>`endif</span> <span class=C>// HAS_DEBUG
</span>

<span class=K>endmodule</span>

<span class=M>`endif</span> <span class=C>// PACOBLAZE_ALU_V_
</span>
</pre>
<center><table class=NB cols=7 ><tr><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index.html';"><a target="_top" href="index.html">Hierarchy</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-f.html';"><a target="_top" href="index-f.html">Files</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-m.html';"><a target="_top" href="index-m.html">Modules</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-s.html';"><a target="_top" href="index-s.html">Signals</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-t.html';"><a target="_top" href="index-t.html">Tasks</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='index-fn.html';"><a target="_top" href="index-fn.html">Functions</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='http://www.burbleland.com/v2html/help_7_30.html?htf-ni-s-';"><a target="_top" href="http://www.burbleland.com/v2html/help_7_30.html?htf-ni-s-">Help</a></td></tr></table></center>
<script language="JavaScript"type="text/javascript"><!--
function next_page() { return ""; }
function first_page() { return ""; }
var extra_info = [
[]
];
disabled=0;
// -->
</script>
<hr>
<table>
 <tr><td><i>This page:</i></td>
  <td><i>Maintained by:</i></td>
  <td><i><a href="mailto:pablo.N@SPAM.bleyer.org">
  pablo.N@SPAM.bleyer.org</a></i></tr>
<tr>
<td> </td>
  <td><i>Created:</i></td><td><i>Tue May 29 02:37:53 2007</i></td></tr>
<tr>
 <td> </td>
 <td><i>From:</i></td><td><i>
  <a href="pacoblaze_alu.v">
pacoblaze_alu.v</a></i></td></tr>
</table>
<hr>
<table width="100%"><tr><td><i>Verilog converted to html by  <a target="_top" href="http://www.burbleland.com/v2html/v2html.html">  v2html 7.30</a> 
 (written by <a href="mailto:v2html730@burbleland.com">Costas Calamvokis</a>).</i></td><td align="right"><b><a href="http://www.burbleland.com/v2html/help_7_30.html?htf-ni-s-">Help</a></b></td></tr></table><table height="90%"><tr><td></td></tr></table>
</body>
</html>
